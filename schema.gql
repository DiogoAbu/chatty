#
# User
#
mutation CreateAccount($data: CreateAccountInput!) {
  createAccount(data: $data) {
    user {
      id
      name
      email
      role
      lastAccessAt
      createdAt
    }
    token
  }
}

mutation SignIn($data: SignInInput!) {
  signIn(data: $data) {
    user {
      id
      name
      email
      role
      lastAccessAt
      createdAt
    }
    token
  }
}

mutation ForgotPassword($data: ForgotPasswordInput!) {
  forgotPassword(data: $data)
}

mutation ChangePassword($data: ChangePasswordInput!) {
  changePassword(data: $data)
}

query Me {
  me {
    id
    name
    email
    role
    lastAccessAt
    createdAt
  }
}

query ListUsers($where: ListUsersWhere, $order: ListUsersOrder, $skip: Int, $take: Int) {
  listUsers(where: $where, order: $order, skip: $skip, take: $take) {
    id
    name
    email
  }
}

#
# Room
#
mutation CreateRoom($data: CreateRoomInput!) {
  createRoom(data: $data) {
    id
    name
    members {
      id
      name
    }
  }
}

query GetRooms {
  getRooms {
    id
    name
    lastMessage {
      id
      content
      createdAt
      user {
        id
        name
      }
    }
    members {
      id
      name
    }
  }
}

subscription RoomCreated {
  roomCreated {
    id
    name
    lastMessage {
      id
      content
      createdAt
      user {
        id
        name
      }
    }
    members {
      id
      name
    }
  }
}

#
# Message
#
mutation CreateMessage($data: CreateMessageInput!) {
  createMessage(data: $data) {
    id
  }
}

query GetMessages($roomId: ID, $limit: Int, $afterDate: Timestamp) {
  getMessages(roomId: $roomId, limit: $limit, afterDate: $afterDate) {
    hasMore
    cursor
    items {
      id
      content
      user {
        id
        name
      }
      createdAt
    }
  }
}

subscription MessageCreated($roomIds: [ID]) {
  messageCreated(roomIds: $roomIds) {
    id
    content
    user {
      id
      name
    }
    room {
      id
      name
    }
    createdAt
  }
}

#
# Sync
#
query PullChanges($lastPulledAt: Float) {
  pullChanges(lastPulledAt: $lastPulledAt)
}

mutation PushChanges($changes: JSON, $lastPulledAt: Float) {
  pushChanges(changes: $changes, lastPulledAt: $lastPulledAt)
}

#
# Notification
#
mutation RegisterDevice($data: RegisterDeviceInput!) {
  registerDevice(data: $data)
}
